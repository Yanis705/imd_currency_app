if(null!==localStorage.getItem("token")){let e="http://localhost:3000";function appendHistory(){fetch("/api/v1/getLatestTransfers",{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(t=>{console.log(t);let n=document.querySelector(".transactionHistory");n.innerHTML="",e(t);let a=document.createElement("a");a.className="btn",a.setAttribute("href","transfer/history"),a.innerHTML="FULL HISTORY",n.appendChild(a)}).catch(e=>{localStorage.removeItem("token"),window.location="/login"});let e=e=>{if(0===e.data.transfers.length){let e=document.createElement("div");e.className="transaction noTransaction";let t=document.createElement("p");t.className="noTrasactions",t.innerHTML="You don't have any transactions! Let's make one!",e.appendChild(t),document.querySelector(".transactionHistory").appendChild(e)}e.data.transfers.forEach(t=>{let n=t.date,a=new Date(n),o=a.getDate(),r=a.getMonth(),l=t.from,s=t.to,i=t.reason,c=t.IMDollars,d=document.createElement("a");d.setAttribute("href","/");let m=document.createElement("div");m.className="transaction",d.appendChild(m);let p=document.createElement("div");p.className="transaction__date",m.appendChild(p);let u=document.createElement("p");u.className="transaction__date--large",u.innerHTML=("0"+o).slice(-2),p.appendChild(u);let h=document.createElement("p");h.innerHTML=("0"+r).slice(-2),p.appendChild(h);let H=document.createElement("div");H.className="transaction__info",m.appendChild(H);let f=document.createElement("p");e.data.user.username==l?f.innerHTML=s:e.data.user.username!==l&&(f.innerHTML=l),H.appendChild(f);let g=document.createElement("p");g.className="transaction__info--small",g.innerHTML=i,H.appendChild(g);let L=document.createElement("div");L.className="transaction__amount",m.appendChild(L);let T=document.createElement("p");e.data.user.username==l?(T.innerHTML="-$"+c,T.className="transaction__amount--negative"):e.data.user.username!==l&&(T.innerHTML="+$"+c,T.className="transaction__amount--positive"),L.appendChild(T),document.querySelector(".transactionHistory").appendChild(d)})}}Primus.connect(e,{reconnect:{max:1/0,min:500,retries:10}}).on("data",e=>{"refreshLatestHistory"===e.action&&appendHistory()}),window.onload=appendHistory()}else window.location="/login";