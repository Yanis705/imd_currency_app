if(null!==localStorage.getItem("token")){let e="http://localhost:3000";function appendHistory(){fetch("/api/v1/getLatestTransfers",{method:"get",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>e.json()).then(t=>{console.log(t);let n=document.querySelector(".transactionHistory");n.innerHTML="",e(t);let a=document.createElement("a");a.className="btn",a.setAttribute("href","transfer/history"),a.innerHTML="FULL HISTORY",n.appendChild(a)}).catch(e=>{localStorage.removeItem("token"),window.location="/login"});let e=e=>{e.data.transfers.forEach(t=>{let n=t.date,a=new Date(n),o=a.getDate(),r=a.getMonth(),l=t.from,i=t.to,s=t.reason,c=t.IMDollars,d=document.createElement("a");d.setAttribute("href","/");let m=document.createElement("div");m.className="transaction",d.appendChild(m);let p=document.createElement("div");p.className="transaction__date",m.appendChild(p);let u=document.createElement("p");u.className="transaction__date--large",u.innerHTML=("0"+o).slice(-2),p.appendChild(u);let h=document.createElement("p");h.innerHTML=("0"+r).slice(-2),p.appendChild(h);let H=document.createElement("div");H.className="transaction__info",m.appendChild(H);let g=document.createElement("p");e.data.user.username==l?g.innerHTML=i:e.data.user.username!==l&&(g.innerHTML=l),H.appendChild(g);let _=document.createElement("p");_.className="transaction__info--small",_.innerHTML=s,H.appendChild(_);let f=document.createElement("div");f.className="transaction__amount",m.appendChild(f);let L=document.createElement("p");e.data.user.username==l?(L.innerHTML="-$"+c,L.className="transaction__amount--negative"):e.data.user.username!==l&&(L.innerHTML="+$"+c,L.className="transaction__amount--positive"),f.appendChild(L),document.querySelector(".transactionHistory").appendChild(d)})}}Primus.connect(e,{reconnect:{max:1/0,min:500,retries:10}}).on("data",e=>{"refreshLatestHistory"===e.action&&appendHistory()}),window.onload=appendHistory()}else window.location="/login";